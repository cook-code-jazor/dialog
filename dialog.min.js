(function(a){var c={},d={buttons:null,title:null,titleAlign:"center",buttonAlign:"center",bodyAlign:"center",buttonNoBorder:true,buttonBorderRadius:true,autoClose:0,onOpen:null,onClose:null,replaceAlert:false,bgWhite:false},b=0;a.MWIN=(function(){var m={};function n(K,M){if(arguments.length<2){return null}var L=null;for(var O=1;O<arguments.length;O++){L=arguments[O];for(var N in L){if(!L.hasOwnProperty(N)){continue}K[N]=L[N]}}return K}function t(K){if(!K){return document}var L=K.target;if(!L){L=K.srcElement}if(L.nodeType===3){L=L.parentNode}return L||document}function B(L,M,N,K){if(L.addEventListener){L.addEventListener(M,N,K===true)}else{if(L.attachEvent){L.attachEvent("on"+M,N)}else{L["on"+M]=N}}var O=L==document?"dlg-body":L.getAttribute("data-id");if(!O){O="dlg-"+Math.random().toString().substr(2);L.setAttribute("data-id",O)}if(!m[O]){m[O]={}}if(!m[O][M]){m[O][M]=[]}m[O][M].push(N)}function A(L,M,N,K){if(L.removeEventListener){L.removeEventListener(M,N,K===true)}else{if(L.detachEvent){L.detachEvent("on"+M,N)}else{L["on"+M]=null}}}function z(M,N,O,L){var Q=M==document?"dlg-body":M.getAttribute("data-id");if(!Q){return}if(!m[Q]||!m[Q][N]){return}var R=m[Q][N];if(O===undefined||typeof O=="boolean"){if(typeof O=="boolean"){L=O}while(R.length>0){A(M,N,R.pop(),L)}m[Q][N]=null;return}else{var K=-1;for(var P=0;P<R.length;P++){if(R[P]==O){K=P;break}}if(K==-1){return}R.splice(K,1);if(R.length==0){m[Q][N]=null}A(M,N,O,L)}}function j(K){if(K&&typeof K=="object"){return K}return new RegExp("\\b("+K.replace(/\-/g,"\\-").replace(/\s+/g,"|")+")\\b","g")}function f(L,K,M){L.className=((L.className||"").replace(j(K),"")+" "+(M||K)).replace(/\s+/g," ").replace(/(^\s+|\s+$)/g,"")}function E(L,K){L.className=(L.className||"").replace(j(K),"").replace(/\s+/g," ").replace(/(^\s+|\s+$)/g,"")}function u(L,K){return j(K).test(L.className||"")}function I(N,K){var L=j(K),M=u(N,L);if(M){E(N,L)}else{f(N,L,K)}return M}function w(K){return K&&typeof K=="function"}function y(K){K=K.nextSibling;while(K&&K.nodeType!=1){K=K.nextSibling}return K}function C(K){K=K.previousSibling;while(K&&K.nodeType!=1){K=K.previousSibling}return K}function q(K){K=K.firstChild;if(K&&K.nodeType!=1){K=y(K)}return K}function x(K){K=K.lastChild;if(K&&K.nodeType!=1){K=C(K)}return K}function l(N,M,P,K,L,O){this.name=N;this.main=M;this.title=P;this.body=K;this.buttonset=L;this.options=O;this.callbacks=null;this.args=null}l.prototype.close=function(K){if(typeof K=="number"){K=this.callbacks?(this.callbacks[K]||null):null}h(this.name,K)};l.prototype.open=function(){return k.apply(window,this.args||arguments)};l.prototype.setTitle=function(K){if(K===null){this.title.style.display="none";f(this.body,"dlg-body-notitle")}else{this.title.style.display="block";this.title.innerHTML=J(K);E(this.body,"dlg-body-notitle")}};l.prototype.content=function(K){if(K===undefined){return q(this.body).innerHTML}else{this.body.innerHTML=J(K)}};l.prototype.fix=function(N){var K=this.main.offsetHeight;var O=this.title.parentNode;var L=O.offsetHeight;if(K&&L){var M=Math.floor((K-L)/2-N);if(M<=0){M=100}O.style.marginTop=M+"px"}};function k(){var U="",Q="",V={},T=arguments.length,M;if(T==0){return}for(var S=0;S<T;S++){M=arguments[S];if(typeof M=="object"){n(V,d,M)}else{if(typeof M=="string"){if(Q==""){Q=M}else{if(U==""){U=Q;Q=M}else{return}}}}}if(!U){U="dlg-"+Math.random().toString().substr(2)}var R=document.getElementById(U),K,W,N,O;if(!R){R=document.createElement("div");R.id=U;document.body.appendChild(R)}R.innerHTML='<div class="dialog"><h1></h1><div class="dlg-body'+(V.icon?" with-icon":"")+'"></div><div class="button-sets"></div></div>';f(R,"blocker"+(V.bgWhite===true?" white":""));K=q(R);W=q(K);N=y(W);O=x(K);N.innerHTML=J((V.icon?'<i class="icon icon-'+V.icon+'"></i>':"")+(Q||V.content||""));K.style.alpha="0";K.style.opacity="0";K.style.filter="alpha(opacity=0)";R.style.display="block";var L=new l(U,R,W,N,O,V);L.args=arguments;c[U]=L;r(O,L);if(V.title===null){W.style.display="none";f(N,"dlg-body-notitle")}else{W.style.display="block";W.innerHTML=J(V.title)}if(V.iconClose===true){var P=document.createElement("i");P.innerHTML="×";W.appendChild(P);B(P,"click",function(){L.close(L.options.buttons?L.options.buttons.length-1:null)})}if(V.defaultWidth&&!V.width){V.width=V.defaultWidth}if(V.width){if(typeof V.width=="number"){V.width=V.width+"px"}K.style.width=V.width}if(V.height){if(typeof V.height=="number"){V.height=(V.height-W.offsetHeight-O.offsetHeight)+"px"}N.style.height=V.height}if(V.autoClose&&typeof V.autoClose=="number"){window.setTimeout(function(){h(U,null)},V.autoClose)}F(W,V.titleAlign);F(N,V.bodyAlign);F(O,V.buttonAlign);if(w(V.onOpen)){V.onOpen.call(L)}if(typeof V.autoFix=="number"){L.fix(V.autoFix)}K.style.alpha="100%";K.style.opacity="1";K.style.filter="alpha(opacity=100%)";return L}function J(K){return'<div class="align-wapper">'+K+"</div>"}function F(L,K){E(L,"align-left align-center align-right");f(L,"align-"+K)}function h(M,O){var N=o(M);if(!N){return}var K=c[M];if(K){if(O){if(w(O.callback)){if(O.callback.call(M,O.data)===false){return}}}if(w(K.options.onClose)){if(K.options.onClose.call(K,O)===false){return}}var L=K.buttonset;if(L){z(L,"click")}}N.parentNode.removeChild(N);c[M]=null}function s(L,K,M){B(document,L,function(O){O=O||event;if(!O){return}var Q=O.keyCode||O.witch;if(!Q){return}if(Q!=K){return}var R=x(document.body);if(!u(R,"blocker")){return}var N=c[R.id];if(!N){return}var S=N.callbacks;if(!S){return}for(var P=0;P<S.length;P++){if(S[P]&&S[P][M]===true){h(N.name,S[P]);break}}})}function r(N,L){var K=L.options.buttons,W=L.name;if(!K||(typeof K=="object"&&K.constructor==Array&&K.length==0)){N.style.display="none"}else{if(typeof K=="object"){var V=K;if(K.constructor!=Array){V=[];var P=null,U=0,R=null;for(var M in K){if(!K.hasOwnProperty(M)){continue}R=K[M];P=typeof R=="string"?R:null;U=M.lastIndexOf(".");if(U>0&&M.substr(U-1,1)!="\\"){P=M.substr(U+1);M=M.substr(0,U)}M=M.replace(/\\\./g,".");V.push({title:M,callback:typeof R=="string"?null:R,className:P,data:null,isDefault:false,isCancel:false,index:V.length})}}if(V.length==0){N.style.display="none"}else{N.style.display="block";f(N,"button-count-"+V.length);var S="",M,Q=-1,O=[];for(var T=0;T<V.length;T++){M=V[T];if(M.isDefault===true){Q=T}O=[M.className?M.className:"btn-primary"];if(T==0){O.push("btn-index-first")}else{if(T==V.length-1){O.push("btn-index-last")}else{O.push("btn-index-middle")}}if(L.options.buttonNoBorder!==false){O.push("no-border")}if(L.options.buttonBorderRadius===true){O.push("btn-radius")}S+='<button class="'+O.join(" ")+'" data-value="'+T+'">'+M.title+"</button>"}N.innerHTML=J(S);if(Q>=0){N.getElementsByTagName("button")[Q].focus()}B(N,"click",function(X){var Y=p(X,W);if(!Y){return}h(W,Y)});L.callbacks=V}}}}function p(K,M){K=t(K||event);if(K&&K.nodeName&&K.nodeName.toLowerCase()!="button"){return null}var N=K.getAttribute("data-value");if(N===undefined){return null}var L;if(!c[M]||!(L=c[M]["callbacks"])){return null}N=parseInt(N);if(!L[N]){return null}return L[N]}function o(K){var L=document.getElementById(K);if(!L){if(c[K]){c[K]=null}return null}return L}function G(){var Q=null,M="",O=arguments.length,K,P={},L=0;if(O==0){return}for(var N=0;N<O;N++){K=arguments[N];if(typeof K=="number"){L=K}else{if(typeof K=="object"){P=K}else{if(typeof K=="string"){if(M==""){M=K}else{Q=K}}}}}if(!Q&&!P.hasOwnProperty("title")){Q="提示"}return k("tips",M,n(P,{title:Q||P.title,autoClose:L,buttons:null}))}G.html=function(K){v("tips",K)};G.title=function(K){H("tips",K)};var e=window.alert;function g(){var R="",N="",M=null,P=arguments.length,K,Q={};if(P==0){return}for(var O=0;O<P;O++){K=arguments[O];if(w(K)){M=K}else{if(typeof K=="object"){Q=K}else{if(typeof K=="string"){if(N==""){N=K}else{R=K}}}}}if(!R&&!Q.hasOwnProperty("title")){R="信息提示"}var L=[{isCancel:true,title:Q.buttonText||"确定",callback:M||Q.callback}];if(Q.buttons===false){L=null}return k("alert",N,n(Q,{title:R||Q.title,buttons:L}))}g.html=function(K){v("alert",K)};g.title=function(K){H("alert",K)};g.restore=function(){window.alert=e;d.replaceAlert=false};if(d.replaceAlert===true){window.alert=g}function i(){var T="",N="",R=null,Q=null,M=null,P=arguments.length,K,S={};if(P==0){return}for(var O=0;O<P;O++){K=arguments[O];if(w(K)){if(!R){R=K}else{Q=K}}else{if(typeof K=="object"){S=K}else{if(typeof K=="boolean"){M=K}else{if(typeof K=="string"){if(N==""){N=K}else{T=K}}}}}}if(!T&&!S.hasOwnProperty("title")){T="信息确认"}var L=[{title:S.buttonTextOk||"确定",callback:R||S.onConfirm},{isCancel:true,title:S.buttonTextCancel||"取消",callback:Q||S.onCancel,className:"btn-grey"}];if(M===true||S.cancelFirst===true){L.reverse()}if(S.buttons===false){L=null}return k(S.name||"confirm",N,n(S,{title:T||S.title,buttons:L}))}i.html=function(K){v("confirm",K)};i.title=function(K){H("confirm",K)};function D(){var Q="",M=null,O=arguments.length,L,P={};if(O==0){return}for(var N=0;N<O;N++){L=arguments[N];if(w(L)){M=L}else{if(typeof L=="object"){P=L}else{if(typeof L=="string"){Q=L}}}}M=M||P.callback;var K="input-prompt-"+b;P.width=P.width||"350px";return k("prompt",'<input id="'+K+'" class="input-prompt" type="text" />',n(P,{title:Q||P.title,buttons:[{title:P.buttonText||"确定",callback:function(){if(w(M)){return M.call(this,document.getElementById(K).value)}}},{isCancel:true,title:P.buttonTextCancel||"取消",callback:P.onCancel,className:"btn-grey"}]}))}D.title=function(K){H("prompt",K)};function v(L,M){var K=c[L];if(!K){return}K.body.innerHTML=J(M)}function H(L,M){var K=c[L];if(!K){return}K.title.innerHTML=J(M)}s("keydown",13,"isDefault");s("keyup",27,"isCancel");return{any:k,open:k,close:h,tips:G,alert:g,confirm:i,html:v,prompt:D,title:H,options:function(K,L){if(L===undefined){return d[K]}d[K]=L;if(K=="replaceAlert"){if(L===true){window.alert=g}else{window.alert=e}}return this}}}());if(typeof Ajax!="undefined"){Ajax.postJson=function(h,f,e,g){g=g||{};if(g.tips){MWIN.tips(g.tips)}Ajax({url:h,data:f,method:"POST",dataType:"json",opts:g,complete:g.complete||function(){if(g.tips){MWIN.close("tips")}},error:g.error||function(){if(this.opts.errorAutoClose){MWIN.tips(this.opts.errorMessage||"请求失败，系统异常。",this.opts.errorAutoClose)}else{MWIN.alert(this.opts.errorMessage||"请求失败，系统异常。")}},succeed:function(i){if(!i.error){if(typeof e=="function"){e(i.data)}}else{if(this.opts.errorAutoClose){MWIN.tips(i.message,this.opts.errorAutoClose)}else{MWIN.alert(i.message)}}}})}}}(window));